### 스케줄링 (Scheduling)

------

> 스케줄링이란 다중 프로그래밍을 가능하게 하는 운영 체제의 동작 기법이다. 운영 체제는 프로세스 들에게 CPU 등의 자원배정을 적절히 함으로써 시스템의 성능을 개선할 수 있다.
>
> 스케줄링의 필요성을 이해하기 위해 스케줄링이 없는 상태에서의 다중 프로그래밍 환경을 생각해보자. 하나의 프로그램은 시스템 입출력 동안은 잠시 실행이 중단된다. 이때 CPU 자원은 유휴상태가 된다. 만약 스케줄링이 없다면 프로그램이 입출력을 기다리는 동안 CPU 자원은 어디에도 사용되지 않는 상태가 된다. 이렇게 낭비되는 CPU 자원을 사용하기 위해 스케줄링이 존재하는 것이다. 스케줄링은 다중 프로그래밍 환경에서 주기억장치에 적재된 여러 프로그램에 대한 작업을 CPU가 항상 수행하도록 하여 CPU의 이용률을 증진시키는 것이 목적이기 때문이다.
>
> 스케줄링은 CPU가 유휴상태에 놓이지 않도록 작업을 CPU에게 할당하고, 여러 프로그래밍의 작업을 관리하는 역할을 한다. 대부분의 경우 CPU가 처리 가능한 작업량은 한정되어 있는 반면, 처리해야 할 작업량은 많기 때문에 스케줄러는 여러 작업들의 우선순위를 고려하여 CPU에게 할당하는 역할을 한다.





#### 스케줄링의 분류

> 다양한 기준에 따라 스케줄링을 분류할 수 있다. 



##### 스케줄링 큐의 종류와 유형에 따른 분류

> 프로세스를 스케줄링 하기 위한 큐에는 세 가지 종류가 존재한다.

* Job Queue : 현재 시스템 내에 있는 모든 프로세스의 집합
* Ready Queue : 현재 메모리 내에 있으면서 CPU를 잡아서 실행되기를 기다리는 프로세스의 집합
* Device Queue : Device I/O 작업을 대기하고 있는 프로세스의 집합

> 이 큐에 프로세스를 넣고 빼주는 스케줄러는 세 가지 유형으로 구분된다.

* 장기 스케줄러 (Long-term Scheduler or Job Scheduler)

> 메모리는 한정되어 있는데 많은 프로세스들이 한꺼번에 메모리에 올라올 경우, 대용량 메모리에 임시로 저장된다. 이 pool에 저장되어 있는 프로세스 중 어떤 프로세스에 메모리를 할당하여 Ready Queue로 보낼지 결정하는 역할을 한다.
>
> 따라서 장기 스케줄러는 메모리와 디스크 사이의 스케줄링을 담당한다. 프로세스에 메모리와 같은 자원을 할당하며, 메모리에 얼마나 많은 프로그래밍이 적재될 것인지를 제어한다. 이 때 프로세스의 상태는 `new > ready`가 된다.

* 단기 스케줄러 (Short-term Scheduler or CPU Scheduler)

> CPU와 메모리 사이의 스케줄링을 담당한다. Ready Queue에 존재하는 프로세스 중 어떤 프로세스를 running 시킬지를 결정한다. 프로세스에 CPU를 할당하며 이 때 프로세스의 상태는 `ready > running > waiting > ready` 가 된다.

* 중기 스케줄러 (Medium-term Scheduler or Swapper)

> 여유 공간 마련을 위해 프로세스를 통째로 메모리에서 디스크로 쫓아낸다. 이를 swapping이라 한다. 따라서 프로세스에 할당된 메모리 자원을 해제한다. 너무 많은 프로그램이 메모리에 적재되지 않도록 조절하는 역할을 하며, 이 때 프로세스의 상태는 `ready > suspended`가 된다.



##### 단계에 따른 분류

> 스케줄링은 단게에 따라 1단계, 2단계, 3단계 스케줄링으로 나뉜다.

* 1단계 스케줄링

> 작업 또는 승인 스케줄링이라 한다. 어느 작업부터 시스템 내의 자원들을 실제로 사용할 수 있도록 할지를 결정한다. 작업들이 시스템에 들어올 지의 여부를 결정한다.

* 2단계 스케줄링

> 어느 프로세스부터 CPU를 차지할 수 있게 할지 경정한다. 프로세스를 보류시키고 다시 활성화시키는 기법을 사용하여 시스템에 대한 단기적인 부하를 조절한다. 1단계인 작업 승인과 3단계인 CPU 배당 사이의 완충 작용을 한다.

* 3단계 스케줄링

> CPU가 사용이 가능한 경우 어느 프로세스에게 배당할지를 결정한다.



##### 우선순위 변동 여부에 따른 분류

> 프로세스의 우선순위 변동 여부에 따라 정적 스케줄링과 동적 스케줄링으로 구분할 수 있다.

* 정적 스케줄링 (Static Scheduling)

> 프로세스에 부여된 우선순위가 바뀌지 않는다. 고정우선순위 스케줄링이라고도 한다.

* 동적 스케줄링 (Dynamic Scheduling)

> 스케줄링 과정에서 프로세스의 우선순위를 변동시키니다. 유동우선순위 스케줄링이라고도 한다. 대표적인 예로 대기시간이 긴 프로세스의 우선순위를 높이는 에이징(Aging) 기법이 있다.



##### 스케줄링의 결정 시점과 선점 유무에 따른 분류

> CPU 스케줄링의 결정 시점은 다음과 같은 프로세스의 상태 변화가 있을 경우 뿐이다.

```
1. 수행 > 대기
2. 수행 > 준비
3. 대기 > 준비
4. 수행 > 종료
```

> 스케줄링은 스케줄링 적용 시점에 따라 비선점형과 선점형으로 구분된다. 비선점형은 위의 결정 시점 중 1번과 4번의 상황에서만 수행되며, 선점형은 1번과 4번까지 모든 상황에서 수행된다.

* 비선점형 스케줄링 (Non-preemptive Scheduling)

> 어떤 프로세스가 CPU를 할당 받으면 그 프로세스가 종료되거나 입출력 요구가 발생하여 자발적으로 중지될 때 까지 계속 실행됨을 보장한다. 순서대로 처리되는 공정성이 있으며, 다음에 처리할 프로세스와 관계없이 응답 시간을 예상할 수 있다. 또한 선점 방식보다 스케줄러 호출 빈도가 낮고 문맥 교환에 의한 오버헤드가 적다. 일괄처리 시스템에 적합하여, CPU 사용 시간이 긴 하나의 프로세스가 CPU 사용 시간이 짧은 여러 프로세스를 오랫동안 대기시킬 수 있으므로, 처리율이 떨어질 수 있다는 단점이 있다.

* 선점형 스케줄링 (Preemptive Scheduling)

> 어떤 프로세스가 CPU를 할당받아 실행 중에 있어도 다른 프로세스가 실행 중인 프로세스를 중지하고 CPU를 강제로 점유할 수 있다. 모든 프로세스에게 CPU 사용시간을 동일하게 부여할 수 있으며 빠른 응답시간을 요구하는 대화식 시분할 시스템에 적합하다. 긴급한 프로세서를 제어하기에 용이하다. 운영 체제가 프로세서 자원을 선점하고 있다가 각 프로세스의 요청이 있을 때 특정 요건들을 기준으로 자원을 배분하는 방식이다.





#### 스케줄링 알고리즘

> 비선점형 스케줄링과 선점형 스케줄링으로 나뉜다.



##### 비선점형 스케줄링

* ##### FCFS (First Come First Served)

> 선입 선처리 스케줄링은 큐를 기준으로 먼저 온 프로세스를 먼저 처리하는 방식이다. 따라서 프로세스에 CPU가 할당되면 해당 프로세스가 완료될 때까지 CPU를 반환하지 않는다. 할당된 CPU가 반환되어야 스케줄링이 이루어진다.
>
> FCFS는 소요시간이 긴 프로세스가 먼저 도달하는 경우 효율이 낮아지는 현상이 발생하는 문제가 있다. 이를 convoy effect라 한다.

* ##### SJF (Shortest Job First)

> 최단 작업 우선 스케줄링은 평균 대기시간을 최소화하기 위해 CPU 점유 시간이 가장 짧은 프로세스에게 CPU를 우선적으로 할당하는 방식이다. 평균 대기 시간을 최소화 하는데 최적화된 알고리즘이지만, 점유 시간이 긴 프로세스가 지속적으로 CPU를 할당받지 못하는 starvation 문제가 발생할 수 있다.

* ##### HRRN (Highest Response Ratio Next)

> 이 스케줄링에서 우선순위를 결정하는 식은 다음과 같다.

```
Priority = (Waiting Time + Estimated Run Time) / Estimated Run Time
```

> 이 스케줄링은 프로세스 처리 우선순위를 CPU 점유 시간과 대기 시간을 동시에 고려하여 선정한다. SJF에서 발생하는 starvation 문제를 보완하기 위해 개발된 스케줄링 방식이다.



##### 선점형 스케줄링

* ##### RR (Round Robin)

> 각 프로세스에 동일한 크기의 할당 시간을 부여하는 방식의 알고리즘이다. 할당 시간이 지나면 프로세스는 선점당하고 큐의 제일 뒤에 위치한다. 
>
> ...

* ##### SRTF (Shortest Remaining Time First)

> 최소 잔류시간 우선 스케줄링은 SJF 스케줄링을 비선점에서 선점형으로 수정한 알고리즘이다. 프로세스의 점유시간을 기준으로 현재 작업중인 프로세스를 중단시키고 새로 들어온 프로세스의 처리를 시작하는 것이 가능하다. SJF 방식과 마찬가지로 starvation 문제가 발생할 수 있다.

* ##### EDF (Earliest Deadline First Scheduling)

> 최단 마감 우선 스케줄링은 최단 마감시간큐에서 마감시간이 가장 가까운 프로세스를 우선적으로 수행하도록 한다. 

* ##### RM (Rate Monotonic Scheduling)

> 비율 단조 스케줄링은 수행 주기가 가장 짧은 프로세스에 가장 높은 우선순위를 부여하는 방식이다. 수행 주기란 단위시간당 프로세스의 수행 횟수를 의미한다. 프로세스에 부여하는 우선순위의 변동이 없으므로 정적 스케줄링에 해당된다.

* ##### 다단계 큐 스케줄링 (Multiple Queue Scheduling)

> 커널 내의 Ready Queue를 여러 큐로 분리하여 큐 사이에도 우선순위를 부여하는 스케줄링 알고리즘이다. 또한, 각각의









