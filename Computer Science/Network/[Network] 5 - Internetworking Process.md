#### 간략한 설명

------

> 브라우저부터 웹 서버까지 통신 과정은 어떻게 진행되는 것일까? 예를 들어, 브라우저의 주소 창에 `www.naver.com` 이나 `www.google.com` 등의 주소를 입력하면 어떠한 과정을 거쳐 브라우저에 웹 페이지가 보여지는 것일까?
>
> 이 과정을 간략히 요약하면 다음과 같다. 브라우저에서 도메인 주소를 입력하면 DNS 서버를 조회하여 도메인에 해당하는 IP 주소를 요청하게 되고, 해당 IP 주소를 얻어서 해당하는 웹 서버에 접속한다.





#### 조금 더 자세한 설명

------

> 이 과정을 조금 더 자세하게 표현하면 다음과 같다.

* 사용자의 PC는 DHCP 서버로부터 사용자 자신의 IP 주소, 가장 가까운 라우터의 IP 주소, 가장 가까운 DNS 서버의 IP 주소를 받는다.
* 이후 ARP를 이용하여 IP 주소를 기반으로 가장 가까운 라우터의 MAC 주소를 알아낸다.
* 외부와 통신할 준비를 마쳤으므로, DNS Query를 DNS 서버에 송신한다. DNS 서버는 이에 대한 결과로 웹 서버의 IP 주소를 사용자의 PC에 돌려준다.
* 이제 웹 서버의 IP 주소를 알게 되었으므로, HTTP Request를 위해 TCP Socket을 개방하고 연결한다. 이 과정에서 3-way-handshake 과정이 일어난다.
* TCP 연결에 성공하게 되면 HTTP Request가 TCP 소켓을 통해 웹 서버로 보내지고, 응답 정보가 사용자의 PC로 들어온다.
* 사용자는 응답 정보를 바탕으로 웹 페이지를 화면에 구성하는 브라우저를 통해 웹 페이지를 볼 수 있다.



##### 용어 설명

> 위 과정에서 사용된 용어의 의미는 다음과 같다.

* DHCP (Dynamic Host Configuration Protocol)

> 호스트의 IP 주소 및 TCP/IP 설정을 클라이언트에게 자동으로 제공하는 프로토콜

* DNS (Domain Server Name)

> IP 주소와 도메인의 매핑정보를 관리하면서 도메인 혹은 IP 주소를 묻는 요청이 오면 이에 응답한다. DNS에도 캐시가 있으므로 자주 요청을 받는 정보는 캐시로 관리한다.

* ARP (Address Resolution Protocol)

> 네트워크 상에서 IP 주소를 물리적 네트워크 주소로 대응시키기 위해 사용되는 프로토콜

* 3 Way Handshake

> TCP/IP를 이용해서 통신을 하는 응용프로그램이 데이터를 전송하기 전에, 먼저 정확한 전송을 봥하기 위해 사전에 세션을 수립하는 과정





#### 더욱 자세한 설명

------

> 이 과정을 더욱 자세하게 설명하면 다음과 같다.



##### Browser

> 사용자가 주소를 입력하면 브라우저는 url 주소창에 입력된 값을 브라우저 내부에서 결정된 규칙에 따라 의미를 조사한다. 조사된 의미에 따라 HTTP Request 메시지를 만든다. 이후 만들어진 메시지를 웹 서버로 전송한다.
>
> 그런데 메시지 전송은 브라우저가 직접하는 것이 아니다. 브라우저는 메시지를 네트워크에 송출하는 기능이 없으므로 메시지 전달을 OS에 의뢰한다. 단, OS에 송신을 의뢰할 때에는 도메인명이 아니라 IP 주소로 메시지를 받을 상대를 지정해야 하므로 이 과정에서 먼저 DNS 서버를 조회하여 IP 주소를 받아오게 된다.



##### Protocol Stack in OS

> OS에는 네트워크 제어용 소프트웨어인 프로토콜 스택이라는 것이 있다. 이 프로토콜 스택이 브라우저로부터 전달된 메시지를 받아 처리하는 역할을 수행한다. 우선 메시지를 패킷에 담은 후, 수신처 주소 등의 제어 정보를 패킷에 덧붙인다. 이후 패킷을 LAN 어댑터에 넘긴다.
>
> 프로토콜 스택은 통신 중 오류가 발생하였을 때, 제어 정보를 사용하여 고쳐 보내거나, 각종 통신 상황을 조절하는 등의 역할도 수행한다.



##### LAN Adapter

> LAN 어댑터는 프로토콜 스택으로부터 받은 패킷을 전기신호로 변환하여 LAN 케이블에 송출시킨다.



##### Hub, Switch, Router

> LAN 어댑터가 송신한 패킷은 허브나 스위치 등을 경우하여 인터넷 접속용 라우터에 도착한다. 라우터는 패킷을 프로바이더(통신사)에게 전달한다. 이렇게 패킷이 인터넷으로 들어가게 된다.



##### Access Circuit, Provider

> 패킷은 인터넷의 입구에 있는 통신 회선(액세스 회선)에 의해 통신사용 라우터까지 운반된다. 통신사용 라우털르 거쳐 인터넷의 핵심부로 들어간 패킷은 수많은 고속 라우터들을 거쳐가며 목적지로 전달된다.



##### Firewall, Cache Server

> 라우터를 경유하며 웹 서버 측의 LAN에 패킷이 도착하게 되면, 방화벽이 패킷을 검사한다. 그리고 패킷이 웹 서버까지 갈 필요가 있는지를 캐시 서버가 판단한다. 이때 Request가 요구하는 페이지의 데이터가 캐시 서버에 있으면 웹 서버에 의뢰하지 않고 캐시 서버에 존재하는 값을 읽어 응답으로 보낸다. 페이지의 데이터 중에 다시 이용할 수 있는 것이 있으면 캐시 서버에 저장된다.



##### Web Server

> 패킷이 물리적인 웹 서버에 도착하면 웹 서버의 프로토콜 스택이 패킷을 추출하여 메시지를 복원한다. 그리고 이를 웹 서버의 애플리케이션에 넘긴다. 메시지를 받은 웹 서버 애플리케이션은 요청 메시지에 따른 데이터를 응답 메시지에 넣어 클라이언트로 회송한다. 
>
> 브라우저로부터 웹 서버에 도달한 방식 대로 응답 메시지가 클라이언트로 전달된다.





